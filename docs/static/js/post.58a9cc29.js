(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["post"],{"0efd":function(e,t,n){"use strict";n.r(t);var r=n("1da1"),a=(n("96cf"),n("7a23")),c=n("6c02"),o=function(){var e=function(e){return"data:text/paint; utf-8,"+encodeURIComponent(e)};return{getDownloadLink:e}},u=(n("e17f"),n("2241")),i=(n("9a83"),n("f564")),s=(n("ac1f"),n("5319"),n("d3b7"),n("1276"),n("e762")),l=n("65d1"),b=(n("a4d3"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0"),n("06c5"));function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(b["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,c=e},f:function(){try{o||null==n["return"]||n["return"]()}finally{if(u)throw c}}}}n("a434"),n("caad"),n("2532"),n("d81d"),n("b0c0"),n("4d63"),n("25f0");var f=function(e,t){var n=e.obj;return new Promise((function(r,a){var c=new FileReader;c.onload=function(){r(c)},c.onerror=a,null!==t&&void 0!==t&&t.accept&&!new RegExp(null===t||void 0===t?void 0:t.accept).test(n.type)&&a({code:1,msg:"wrong file type"}),!n.type||/^text\//i.test(n.type)?c.readAsText(n,e.encoding):c.readAsDataURL(n)}))};function p(e,t){return v.apply(this,arguments)}function v(){return v=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f(t,n);case 2:r=e.sent,"string"==typeof r.result&&(t.content=r.result),t.hasRead=!0;case 5:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}var j=p,O=function(){var e=Object(a["ref"])([]),t=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(n instanceof FileList)){t.next=5;break}return t.next=3,m(n,e.value);case 3:t.next=11;break;case 5:if(!(n.file instanceof File)){t.next=10;break}return t.next=8,m(n.file,e.value);case 8:t.next=11;break;case 10:console.log(n);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=function(t){if(t.preventDefault(),"drop"==t.type){var n,r=null===(n=t.dataTransfer)||void 0===n?void 0:n.files;r&&m(r,e.value)}},c=function(t){e.value.splice(t,1)};return{fileMetaList:e,onImportFiles:t,onDropFile:n,onRemoveFile:c}},m=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r,a,c,o,u,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=[],t instanceof File&&(r=[t]),a=0,c=r;a<c.length;a++)o=c[a],n.map((function(e){return e.name})).includes(o.name)?Object(i["a"])("文件【".concat(o.name,"】重复。")):n.unshift({obj:o,name:o.name,hasRead:!1,encodingGot:!1,encoding:"utf-8"});u=d(n),e.prev=4,u.s();case 6:if((s=u.n()).done){e.next=21;break}if(l=s.value,!l.hasRead){e.next=10;break}return e.abrupt("continue",19);case 10:return e.prev=10,e.next=13,j(l);case 13:Object(i["a"])({type:"success",message:"文件读取成功",duration:1e3}),e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](10),Object(i["a"])({type:"warning",message:"".concat(e.t0),duration:5e3});case 19:e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e["catch"](4),u.e(e.t1);case 26:return e.prev=26,u.f(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[4,23,26,29],[10,16]])})));return function(t,n){return e.apply(this,arguments)}}(),h=O,g=n("8b10"),w=n("5cde"),x=n("79f6"),k=n("b383"),y=n.n(k),N=n("641e"),I=function(){return x["a"].get("/1.1/classes/Tag")},C=function(e){return x["a"].get("/1.1/classes/Tag?".concat(y.a.stringify(e)))},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(N["a"])();return x["a"].post("/1.1/classes/Tag",{tagName:e,owner:t})},V=function(e){return x["a"].get("/1.1/classes/NoteTagMap?".concat(y.a.stringify(e)))},_=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(N["a"])();return x["a"].post("/1.1/classes/NoteTagMap",{note:{__type:"Pointer",className:"Note",objectId:t},tag:{__type:"Pointer",className:"Tag",objectId:e},owner:n})},T=function(e){return x["a"].delete("/1.1/classes/NoteTagMap/".concat(e))},P=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V({where:JSON.stringify({note:{__type:"Pointer",className:"Note",objectId:t}})});case 2:if(n=e.sent,r=n.results.map((function(e){return e.tag.objectId})),!r.length){e.next=8;break}return e.abrupt("return",C({where:JSON.stringify({objectId:{$in:r}})}));case 8:return e.abrupt("return",{results:[]});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=n("a1e9"),E=n("5c40"),S="#7232dd",M=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:return n=e.sent,e.abrupt("return",n.results.map((function(e,t){return{id:t,text:e.tagName,objId:e.objectId}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){var t=Object(B["r"])([]),n=Object(B["r"])([]),a=Object(B["r"])(!1),c=Object(B["r"])(""),o=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,n.value=t.results.map((function(e,t){return{id:t,text:e.tagName,objId:e.objectId}}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(e,t){var n,r=d(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.text==e)return a}}catch(c){r.e(c)}finally{r.f()}return null},s=function(r){var a=i(r,n.value);a&&(a.color=S,_(a.objId,e),t.value.push(a))},l=function(){var a=Object(r["a"])(regeneratorRuntime.mark((function r(a){var c,o,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(c=i(a,n.value),!c){r.next=8;break}return c.color=void 0,r.next=5,V({where:JSON.stringify({tag:{__type:"Pointer",className:"Tag",objectId:c.objId},note:{__type:"Pointer",className:"Note",objectId:e}})});case 5:for(u in o=r.sent,T(o.results[0].objectId),t.value)t.value[u].text===a&&t.value.splice(+u,1);case 8:case"end":return r.stop()}}),r)})));return function(e){return a.apply(this,arguments)}}(),b=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=c.value,e.next=3,R(t);case 3:return r=e.sent,console.log("新建标签完成，id为",r.objectId),n.value.push({id:n.value.length+1,text:t,objId:r.objectId}),e.abrupt("return",r.objectId);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:s(c.value);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(e){var n=e.target,r=n.textContent||n.innerText;console.log("tagName",r);var a=i(r,t.value);a?l(r):s(r)};return Object(E["mb"])(u),{tagList:t,allTagList:n,showPopInput:a,newTagName:c,handleSelectTag:p,handleAddTag:f}},U=function(e){var t="## 在此编辑您的内容",n="",o="",b=Object(a["ref"])(!1),d=Object(a["ref"])([]),f=function(e){b.value=!1,d.value=e},p=Object(a["reactive"])({content:"",isPublicRead:!1,isPublicWrite:!1,pinned:!1,postId:"",canWrite:!0}),v=Object(a["reactive"])({isImporting:!1,isSaving:!1,isPublicing:!1,isPinning:!1}),j=h(),O=j.fileMetaList,m=j.onImportFiles,x=Object(c["c"])(),k=function(){var a=Object(r["a"])(regeneratorRuntime.mark((function r(){var a,c,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=Object(g["a"])("id"),!a){r.next=26;break}return p.postId=a,r.prev=3,r.next=6,Object(w["d"])(a);case 6:return c=r.sent,p.content=Object(s["a"])(c.content),p.isPublicRead=c.isPublicRead||!1,p.isPublicWrite=c.isPublicWrite||!1,p.pinned=c.pinned||!1,n=p.content,p.isPublicRead&&!p.isPublicWrite&&(p.canWrite=c.owner.objectId===(null===(u=l["a"].get("LcUserInfo"))||void 0===u?void 0:u.objectId)),r.next=15,M(p.postId);case 15:d.value=r.sent,o=JSON.stringify(d.value),r.next=24;break;case 19:r.prev=19,r.t0=r["catch"](3),console.log(r.t0),x.replace("/notes"),Object(i["a"])("".concat(r.t0));case 24:r.next=28;break;case 26:e.value="edit",p.content=t;case 28:case"end":return r.stop()}}),r,null,[[3,19]])})));return function(){return a.apply(this,arguments)}}(),y=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return v.isImporting=!0,e.next=3,m(t);case 3:r=null===(n=O.value[0])||void 0===n?void 0:n.content,r?(p.content=r,p.postId="",x.replace("/post")):Object(i["a"])("读取文件出现错误"),v.isImporting=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.isSaving=!0,e.prev=1,!p.postId){e.next=7;break}return e.next=5,Object(w["i"])({noteContent:p.content,postId:p.postId,tags:d.value});case 5:e.next=12;break;case 7:return e.next=9,Object(w["b"])(p.content);case 9:t=e.sent,p.postId=t.objectId,x.replace("/post?id="+p.postId);case 12:return n=p.content,o=JSON.stringify(d.value),Object(i["a"])({type:"success",message:"保存成功",duration:800}),v.isSaving=!1,e.abrupt("return",!0);case 19:return e.prev=19,e.t0=e["catch"](1),Object(i["a"])("保存失败：".concat(e.t0)),v.isSaving=!1,e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=function(e){return new Promise((function(t){"confirm"===e?p.postId?Object(w["c"])(p.postId).then((function(){Object(i["a"])({type:"success",message:"操作成功：笔记已删除"}),x.push("/notes")})).catch((function(e){Object(i["a"])("删除失败：".concat(e))})).finally((function(){t(!0)})):(Object(i["a"])("删除失败：笔记未保存，不需要删除"),t(!0)):t(!0)}))};u["a"].confirm({title:"文件删除后将无法恢复",confirmButtonText:"删除",beforeClose:e})},C=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u["a"].confirm({message:"请选择其他用户对该笔记的权限",confirmButtonText:"编辑",cancelButtonText:"只读"});case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.isPublicing=!0,e.prev=1,!p.postId){e.next=20;break}if(!p.isPublicRead){e.next=9;break}return e.next=6,Object(w["a"])(p.postId);case 6:p.isPublicWrite=!1,e.next=15;break;case 9:return e.next=11,C();case 11:return t=e.sent,e.next=14,Object(w["f"])(p.postId,t);case 14:t&&(p.isPublicWrite=!0);case 15:n=p.isPublicRead?"取消公开":"公开",p.isPublicRead=!p.isPublicRead,Object(i["a"])({type:"success",message:"操作成功：笔记已".concat(n)}),e.next=21;break;case 20:Object(i["a"])("请先保存笔记");case 21:e.next=26;break;case 23:e.prev=23,e.t0=e["catch"](1),Object(i["a"])("".concat(e.t0));case 26:v.isPublicing=!1;case 27:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.isPinning=!0,e.prev=1,!p.postId){e.next=10;break}return e.next=5,Object(w["g"])(p.postId,p.pinned);case 5:t=p.pinned?"取消置顶":"置顶",p.pinned=!p.pinned,Object(i["a"])({type:"success",message:"操作成功：笔记已".concat(t)}),e.next=11;break;case 10:Object(i["a"])("请先保存笔记");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](1),Object(i["a"])("".concat(e.t0));case 16:v.isPinning=!1;case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(p.content!=t&&p.content!=n){e.next=4;break}return e.abrupt("return",!0);case 4:return e.prev=4,e.next=7,u["a"].confirm({title:"确认返回吗？",message:"笔记不会自动保存哦"});case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e["catch"](4),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}(),T=Object(a["computed"])((function(){var e=p.content.split("\n")[0];return"#"==e[0]?e.replace(/#+ /g,""):e}));return Object(a["onBeforeMount"])(k),Object(a["onBeforeUnmount"])(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(JSON.stringify(d.value)===o){e.next=3;break}return e.next=3,Object(w["i"])({noteContent:p.content,postId:p.postId,tags:d.value});case 3:case"end":return e.stop()}}),e)})))),{saveFileName:T,postInfo:p,status:v,showTagManage:b,tagList:d,handleUpdateTags:f,handlePin:V,handlePublic:R,saveNote:N,deleteNote:I,importNote:y,checkIfSaved:_}},A=n("6ee2"),W=n("a834");n("4de4");Object(a["pushScopeId"])("data-v-d2525d1a");var F={class:"all-tags-wrap"},J=Object(a["createTextVNode"])(" +新建标签 "),z=Object(a["createTextVNode"])(" 完成 ");Object(a["popScopeId"])();var D=Object(a["defineComponent"])({props:{isShow:{type:Boolean,required:!0},postId:{type:String,required:!0},postTags:{type:Array,required:!0}},emits:["close"],setup:function(e){var t=e,n=Object(a["ref"])(t.isShow),r=Object(a["ref"])("");Object(a["watch"])((function(){return t.isShow}),(function(){n.value=t.isShow}));var c=L(t.postId),o=c.tagList,u=c.allTagList,i=c.showPopInput,s=c.newTagName,l=c.handleSelectTag,b=c.handleAddTag;return Object(a["watch"])((function(){return t.postTags}),(function(){o.value=t.postTags;var e,n=d(o.value);try{var r=function(){var t=e.value,n=u.value.filter((function(e){return e.text==t.text}));n[0].color=S};for(n.s();!(e=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}})),function(e,t){var c=Object(a["resolveComponent"])("van-field"),d=Object(a["resolveComponent"])("van-cell-group"),f=Object(a["resolveComponent"])("van-button"),p=Object(a["resolveComponent"])("van-action-sheet"),v=Object(a["resolveComponent"])("van-cell"),j=Object(a["resolveComponent"])("van-popup");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(p,{show:n.value,"onUpdate:show":t[3]||(t[3]=function(e){return n.value=e}),title:"添加标签",onClose:t[4]||(t[4]=function(t){return e.$emit("close",Object(a["unref"])(o))})},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(d,{inset:""},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{class:"current-tags-wrap"},{input:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(W["a"],{tags:Object(a["unref"])(o)},null,8,["tags"]),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.value=e}),type:"text",class:"van-field__control",placeholder:"选择或搜索标签"},null,512),[[a["vModelText"],r.value]])]})),_:1})]})),_:1}),Object(a["createVNode"])(d,{inset:"",title:"全部标签"},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("div",F,[Object(a["createElementVNode"])("span",{onClick:t[1]||(t[1]=function(){return Object(a["unref"])(l)&&Object(a["unref"])(l).apply(void 0,arguments)})},[Object(a["createVNode"])(W["a"],{tags:Object(a["unref"])(u),color:"gray",mode:"button"},null,8,["tags"])]),Object(a["createVNode"])(f,{size:"small",plain:"",onClick:t[2]||(t[2]=function(e){return i.value=!0})},{default:Object(a["withCtx"])((function(){return[J]})),_:1})])]})),_:1})]})),_:1},8,["show"]),Object(a["createVNode"])(j,{class:"new-tag-wrap",show:Object(a["unref"])(i),"onUpdate:show":t[6]||(t[6]=function(e){return Object(a["isRef"])(i)?i.value=e:null}),round:""},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(v,{value:"新建标签"}),Object(a["createVNode"])(d,{inset:""},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{modelValue:Object(a["unref"])(s),"onUpdate:modelValue":t[5]||(t[5]=function(e){return Object(a["isRef"])(s)?s.value=e:null}),placeholder:"标签名称"},null,8,["modelValue"]),Object(a["createVNode"])(f,{type:"primary",disabled:!Object(a["unref"])(s),onClick:Object(a["unref"])(b)},{default:Object(a["withCtx"])((function(){return[z]})),_:1},8,["disabled","onClick"])]})),_:1})]})),_:1},8,["show"])],64)}}});n("17ad");D.__scopeId="data-v-d2525d1a";var q=D;Object(a["pushScopeId"])("data-v-44ad8c36");var $={class:"editor-wrap"},G={class:"tags-wrap"},H=Object(a["createElementVNode"])("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24"},[Object(a["createElementVNode"])("path",{d:"M5.5 9A1.5 1.5 0 0 0 7 7.5A1.5 1.5 0 0 0 5.5 6A1.5 1.5 0 0 0 4 7.5A1.5 1.5 0 0 0 5.5 9m11.91 2.58c.36.36.59.86.59 1.42c0 .55-.22 1.05-.59 1.41l-5 5a1.996 1.996 0 0 1-2.83 0l-6.99-6.99C2.22 12.05 2 11.55 2 11V6c0-1.11.89-2 2-2h5c.55 0 1.05.22 1.41.58l7 7m-3.87-5.87l1-1l6.87 6.87c.37.36.59.87.59 1.42c0 .55-.22 1.05-.58 1.41l-5.38 5.38l-1-1L20.75 13l-7.21-7.29z",fill:"#7232dd"})],-1),K=Object(a["createTextVNode"])("+"),Q={class:"v-md-editor-wrap"},X={class:"uploader-wrap"},Y=Object(a["createTextVNode"])(" 导入笔记 "),Z=Object(a["createElementVNode"])("div",{class:"uploader-warn van-action-sheet__subname"}," 从本地文件中导入一篇新的笔记，当前未保存内容可能会丢失 ",-1),ee=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1),te=["download","href"],ne=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1),re={key:0},ae={key:1},ce=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1),oe={key:0},ue={key:1},ie=Object(a["createTextVNode"])(" 公开笔记 "),se=Object(a["createElementVNode"])("div",{class:"uploader-warn van-action-sheet__subname"}," 公开以后，所有人都将能看到您的笔记（只读） ",-1),le=[ie,se],be=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1);Object(a["popScopeId"])();var de=Object(a["defineComponent"])({setup:function(e){var t=function(){var e=Object(a["ref"])("preview"),t=Object(a["computed"])((function(){return"edit"===e.value})),n=function(){e.value="edit"===e.value?"preview":"edit"};return{mode:e,isEdit:t,showPreview:n}},n=Object(a["ref"])(!1),u=o(),i=u.getDownloadLink,s=t(),l=s.mode,b=s.isEdit,d=s.showPreview,f=U(l),p=f.status,v=f.postInfo,j=f.saveFileName,O=f.showTagManage,m=f.tagList,h=f.handleUpdateTags,g=f.handlePin,w=f.handlePublic,x=f.saveNote,k=f.deleteNote,y=f.importNote,N=f.checkIfSaved,I=Object(c["c"])(),C=function(){N().then((function(e){1==e&&I.push("/notes")}))},R=function(e){n.value=!1,y(e)},V=function(){n.value=!1,k()},_=function(){x().then((function(){l.value="preview"}))};return Object(a["onMounted"])(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.onbeforeunload=function(){var e="你确定要关闭吗？";return e};case 1:case"end":return e.stop()}}),e)})))),Object(a["onBeforeUnmount"])((function(){window.onbeforeunload=null})),function(e,t){var r=Object(a["resolveComponent"])("van-button"),c=Object(a["resolveComponent"])("van-nav-bar"),o=Object(a["resolveComponent"])("van-tag"),u=Object(a["resolveComponent"])("v-md-editor"),s=Object(a["resolveComponent"])("van-uploader"),f=Object(a["resolveComponent"])("van-action-sheet");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",$,[Object(a["createVNode"])(c,{class:"nav-bar",title:"MyNote"},{left:Object(a["withCtx"])((function(){return[Object(a["unref"])(b)?(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:0,size:"small",onClick:_},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(A["a"],{name:"save",loading:Object(a["unref"])(p).isSaving},null,8,["loading"])]})),_:1})):(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:1,size:"small",onClick:C},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(A["a"],{name:"back"})]})),_:1}))]})),right:Object(a["withCtx"])((function(){return[Object(a["unref"])(v).canWrite?(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:0,size:"small",onClick:Object(a["unref"])(d)},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(A["a"],{name:"showPreview",active:Object(a["unref"])(b)},null,8,["active"])]})),_:1},8,["onClick"])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(r,{size:"small",onClick:t[0]||(t[0]=function(e){return n.value=!0})},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(A["a"],{name:"showMore"})]})),_:1})]})),_:1}),Object(a["createElementVNode"])("div",G,[H,Object(a["createVNode"])(W["a"],{tags:Object(a["unref"])(m)},null,8,["tags"]),Object(a["createVNode"])(o,{plain:"",onClick:t[1]||(t[1]=function(e){return O.value=!0})},{default:Object(a["withCtx"])((function(){return[K]})),_:1})]),Object(a["createElementVNode"])("div",Q,[Object(a["createVNode"])(u,{modelValue:Object(a["unref"])(v).content,"onUpdate:modelValue":t[2]||(t[2]=function(e){return Object(a["unref"])(v).content=e}),mode:Object(a["unref"])(l),"left-toolbar":"undo redo | toc | ul ol quote table link code | clear","right-toolbar":""},null,8,["modelValue","mode"])]),Object(a["createVNode"])(f,{show:n.value,"onUpdate:show":t[6]||(t[6]=function(e){return n.value=e}),"cancel-text":"取消","close-on-click-action":"","safe-area-inset-bottom":""},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("label",X,[Object(a["createVNode"])(s,{accept:".md, .txt","after-read":R},{default:Object(a["withCtx"])((function(){return[Y]})),_:1}),Z]),ee,Object(a["createElementVNode"])("a",{class:"export-wrap",download:Object(a["unref"])(j),href:Object(a["unref"])(i)(Object(a["unref"])(v).content)},[Object(a["createElementVNode"])("button",{class:"van-action-sheet__item",onClick:t[3]||(t[3]=function(e){return n.value=!1})}," 导出笔记 ")],8,te),ne,Object(a["unref"])(v).canWrite?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:0,class:"van-action-sheet__item",onClick:t[4]||(t[4]=function(){return Object(a["unref"])(g)&&Object(a["unref"])(g).apply(void 0,arguments)})},[Object(a["unref"])(v).pinned?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",re,"取消置顶")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",ae,"置顶笔记"))])):Object(a["createCommentVNode"])("",!0),ce,Object(a["unref"])(v).canWrite?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:1,class:"van-action-sheet__item",onClick:t[5]||(t[5]=function(){return Object(a["unref"])(w)&&Object(a["unref"])(w).apply(void 0,arguments)})},[Object(a["unref"])(v).isPublicRead?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",oe,"取消公开")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",ue,le))])):Object(a["createCommentVNode"])("",!0),be,Object(a["unref"])(v).canWrite?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:2,class:"van-action-sheet__item",style:{color:"red"},onClick:V}," 删除笔记 ")):Object(a["createCommentVNode"])("",!0)]})),_:1},8,["show"]),Object(a["createVNode"])(q,{isShow:Object(a["unref"])(O),postId:Object(a["unref"])(v).postId,postTags:Object(a["unref"])(m),onClose:Object(a["unref"])(h)},null,8,["isShow","postId","postTags","onClose"])])}}});n("aa24");de.__scopeId="data-v-44ad8c36";t["default"]=de},"17ad":function(e,t,n){"use strict";n("8004")},8004:function(e,t,n){},a30f:function(e,t,n){},a434:function(e,t,n){"use strict";var r=n("23e7"),a=n("23cb"),c=n("a691"),o=n("50c4"),u=n("7b0b"),i=n("65f0"),s=n("8418"),l=n("1dde"),b=l("splice"),d=Math.max,f=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!b},{splice:function(e,t){var n,r,l,b,j,O,m=u(this),h=o(m.length),g=a(e,h),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=h-g):(n=w-2,r=f(d(c(t),0),h-g)),h+n-r>p)throw TypeError(v);for(l=i(m,r),b=0;b<r;b++)j=g+b,j in m&&s(l,b,m[j]);if(l.length=r,n<r){for(b=g;b<h-r;b++)j=b+r,O=b+n,j in m?m[O]=m[j]:delete m[O];for(b=h;b>h-r+n;b--)delete m[b-1]}else if(n>r)for(b=h-r;b>g;b--)j=b+r-1,O=b+n-1,j in m?m[O]=m[j]:delete m[O];for(b=0;b<n;b++)m[b+g]=arguments[b+2];return m.length=h-r+n,l}})},aa24:function(e,t,n){"use strict";n("a30f")}}]);