(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["post"],{"0efd":function(e,t,n){"use strict";n.r(t);var r=n("1da1"),a=(n("96cf"),n("7a23")),c=n("6c02"),o=function(){var e=function(e){return"data:text/paint; utf-8,"+encodeURIComponent(e)};return{getDownloadLink:e}},i=(n("e17f"),n("2241")),u=(n("9a83"),n("f564")),s=(n("ac1f"),n("5319"),n("d3b7"),n("1276"),n("e762")),l=n("65d1"),f=(n("a4d3"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0"),n("06c5"));function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(f["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n["return"]||n["return"]()}finally{if(i)throw c}}}}n("a434"),n("caad"),n("2532"),n("d81d"),n("b0c0"),n("4d63"),n("25f0");var b=function(e,t){var n=e.obj;return new Promise((function(r,a){var c=new FileReader;c.onload=function(){r(c)},c.onerror=a,null!==t&&void 0!==t&&t.accept&&!new RegExp(null===t||void 0===t?void 0:t.accept).test(n.type)&&a({code:1,msg:"wrong file type"}),!n.type||/^text\//i.test(n.type)?c.readAsText(n,e.encoding):c.readAsDataURL(n)}))};function p(e,t){return v.apply(this,arguments)}function v(){return v=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b(t,n);case 2:r=e.sent,"string"==typeof r.result&&(t.content=r.result),t.hasRead=!0;case 5:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}var j=p,O=function(){var e=Object(a["ref"])([]),t=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(n instanceof FileList)){t.next=5;break}return t.next=3,h(n,e.value);case 3:t.next=11;break;case 5:if(!(n.file instanceof File)){t.next=10;break}return t.next=8,h(n.file,e.value);case 8:t.next=11;break;case 10:console.log(n);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=function(t){if(t.preventDefault(),"drop"==t.type){var n,r=null===(n=t.dataTransfer)||void 0===n?void 0:n.files;r&&h(r,e.value)}},c=function(t){e.value.splice(t,1)};return{fileMetaList:e,onImportFiles:t,onDropFile:n,onRemoveFile:c}},h=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r,a,c,o,i,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=[],t instanceof File&&(r=[t]),a=0,c=r;a<c.length;a++)o=c[a],n.map((function(e){return e.name})).includes(o.name)?Object(u["a"])("文件【".concat(o.name,"】重复。")):n.unshift({obj:o,name:o.name,hasRead:!1,encodingGot:!1,encoding:"utf-8"});i=d(n),e.prev=4,i.s();case 6:if((s=i.n()).done){e.next=21;break}if(l=s.value,!l.hasRead){e.next=10;break}return e.abrupt("continue",19);case 10:return e.prev=10,e.next=13,j(l);case 13:Object(u["a"])({type:"success",message:"文件读取成功",duration:1e3}),e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](10),Object(u["a"])({type:"warning",message:"".concat(e.t0),duration:5e3});case 19:e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e["catch"](4),i.e(e.t1);case 26:return e.prev=26,i.f(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[4,23,26,29],[10,16]])})));return function(t,n){return e.apply(this,arguments)}}(),m=O,g=n("8b10"),w=n("5cde"),x=n("79f6"),k=n("b383"),y=n.n(k),N=n("641e"),I=function(){return x["a"].get("/1.1/classes/Tag")},R=function(e){return x["a"].get("/1.1/classes/Tag?".concat(y.a.stringify(e)))},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(N["a"])();return x["a"].post("/1.1/classes/Tag",{tagName:e,owner:t})},V=function(e){return x["a"].get("/1.1/classes/NoteTagMap?".concat(y.a.stringify(e)))},_=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(N["a"])();return x["a"].post("/1.1/classes/NoteTagMap",{note:{__type:"Pointer",className:"Note",objectId:t},tag:{__type:"Pointer",className:"Tag",objectId:e},owner:n})},E=function(e){return x["a"].delete("/1.1/classes/NoteTagMap/".concat(e))},T=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,V({where:JSON.stringify({note:{__type:"Pointer",className:"Note",objectId:t}})});case 2:if(n=e.sent,r=n.results.map((function(e){return e.tag.objectId})),!r.length){e.next=8;break}return e.abrupt("return",R({where:JSON.stringify({objectId:{$in:r}})}));case 8:return e.abrupt("return",{results:[]});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=n("a1e9"),S=n("5c40"),B="#7232dd",M=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,T(t);case 2:return n=e.sent,e.abrupt("return",n.results.map((function(e,t){return{id:t,text:e.tagName,objId:e.objectId}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){var t=Object(P["r"])([]),n=Object(P["r"])([]),a=Object(P["r"])(!1),c=Object(P["r"])(""),o=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,n.value=t.results.map((function(e,t){return{id:t,text:e.tagName,objId:e.objectId}}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(e,t){var n,r=d(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.text==e)return a}}catch(c){r.e(c)}finally{r.f()}return null},s=function(r){var a=u(r,n.value);a&&(a.color=B,_(a.objId,e),t.value.push(a))},l=function(){var a=Object(r["a"])(regeneratorRuntime.mark((function r(a){var c,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(c=u(a,n.value),!c){r.next=8;break}return c.color=void 0,r.next=5,V({where:JSON.stringify({tag:{__type:"Pointer",className:"Tag",objectId:c.objId},note:{__type:"Pointer",className:"Note",objectId:e}})});case 5:for(i in o=r.sent,E(o.results[0].objectId),t.value)t.value[i].text===a&&t.value.splice(+i,1);case 8:case"end":return r.stop()}}),r)})));return function(e){return a.apply(this,arguments)}}(),f=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=c.value,e.next=3,C(t);case 3:return r=e.sent,console.log("新建标签完成，id为",r.objectId),n.value.push({id:n.value.length+1,text:t,objId:r.objectId}),e.abrupt("return",r.objectId);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:s(c.value);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(e){var n=e.target,r=n.innerText,a=u(r,t.value);a?l(r):s(r)};return Object(S["mb"])(i),{tagList:t,allTagList:n,showPopInput:a,newTagName:c,handleSelectTag:p,handleAddTag:b}},A=function(e){var t="## 在此编辑您的内容",n="",o="",f=Object(a["ref"])(!1),d=Object(a["ref"])([]),b=function(e){f.value=!1,d.value=e},p=Object(a["reactive"])({content:"",isPublicRead:!1,isPublicWrite:!1,pinned:!1,postId:"",canWrite:!0}),v=Object(a["reactive"])({isImporting:!1,isSaving:!1,isPublicing:!1,isPinning:!1}),j=m(),O=j.fileMetaList,h=j.onImportFiles,x=Object(c["c"])(),k=function(){var a=Object(r["a"])(regeneratorRuntime.mark((function r(){var a,c,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=Object(g["a"])("id"),!a){r.next=26;break}return p.postId=a,r.prev=3,r.next=6,Object(w["d"])(a);case 6:return c=r.sent,p.content=Object(s["a"])(c.content),p.isPublicRead=c.isPublicRead||!1,p.isPublicWrite=c.isPublicWrite||!1,p.pinned=c.pinned||!1,n=p.content,p.isPublicRead&&!p.isPublicWrite&&(p.canWrite=c.owner.objectId===(null===(i=l["a"].get("LcUserInfo"))||void 0===i?void 0:i.objectId)),r.next=15,M(p.postId);case 15:d.value=r.sent,o=JSON.stringify(d.value),r.next=24;break;case 19:r.prev=19,r.t0=r["catch"](3),console.log(r.t0),x.replace("/notes"),Object(u["a"])("".concat(r.t0));case 24:r.next=28;break;case 26:e.value="edit",p.content=t;case 28:case"end":return r.stop()}}),r,null,[[3,19]])})));return function(){return a.apply(this,arguments)}}(),y=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return v.isImporting=!0,e.next=3,h(t);case 3:r=null===(n=O.value[0])||void 0===n?void 0:n.content,r?(p.content=r,p.postId="",x.replace("/post")):Object(u["a"])("读取文件出现错误"),v.isImporting=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.isSaving=!0,e.prev=1,!p.postId){e.next=7;break}return e.next=5,Object(w["i"])({noteContent:p.content,postId:p.postId,tags:d.value});case 5:e.next=12;break;case 7:return e.next=9,Object(w["b"])(p.content);case 9:t=e.sent,p.postId=t.objectId,x.replace("/post?id="+p.postId);case 12:return n=p.content,o=JSON.stringify(d.value),Object(u["a"])({type:"success",message:"保存成功",duration:800}),v.isSaving=!1,e.abrupt("return",!0);case 19:return e.prev=19,e.t0=e["catch"](1),Object(u["a"])("保存失败：".concat(e.t0)),v.isSaving=!1,e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=function(e){return new Promise((function(t){"confirm"===e?p.postId?Object(w["c"])(p.postId).then((function(){Object(u["a"])({type:"success",message:"操作成功：笔记已删除"}),x.push("/notes")})).catch((function(e){Object(u["a"])("删除失败：".concat(e))})).finally((function(){t(!0)})):(Object(u["a"])("删除失败：笔记未保存，不需要删除"),t(!0)):t(!0)}))};i["a"].confirm({title:"文件删除后将无法恢复",confirmButtonText:"删除",beforeClose:e})},R=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i["a"].confirm({message:"请选择其他用户对该笔记的权限",confirmButtonText:"编辑",cancelButtonText:"只读"});case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.isPublicing=!0,e.prev=1,!p.postId){e.next=20;break}if(!p.isPublicRead){e.next=9;break}return e.next=6,Object(w["a"])(p.postId);case 6:p.isPublicWrite=!1,e.next=15;break;case 9:return e.next=11,R();case 11:return t=e.sent,e.next=14,Object(w["f"])(p.postId,t);case 14:t&&(p.isPublicWrite=!0);case 15:n=p.isPublicRead?"取消公开":"公开",p.isPublicRead=!p.isPublicRead,Object(u["a"])({type:"success",message:"操作成功：笔记已".concat(n)}),e.next=21;break;case 20:Object(u["a"])("请先保存笔记");case 21:e.next=26;break;case 23:e.prev=23,e.t0=e["catch"](1),Object(u["a"])("".concat(e.t0));case 26:v.isPublicing=!1;case 27:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.isPinning=!0,e.prev=1,!p.postId){e.next=10;break}return e.next=5,Object(w["g"])(p.postId,p.pinned);case 5:t=p.pinned?"取消置顶":"置顶",p.pinned=!p.pinned,Object(u["a"])({type:"success",message:"操作成功：笔记已".concat(t)}),e.next=11;break;case 10:Object(u["a"])("请先保存笔记");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](1),Object(u["a"])("".concat(e.t0));case 16:v.isPinning=!1;case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(p.content!=t&&p.content!=n){e.next=4;break}return e.abrupt("return",!0);case 4:return e.prev=4,e.next=7,i["a"].confirm({title:"确认返回吗？",message:"笔记不会自动保存哦"});case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e["catch"](4),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}(),E=Object(a["computed"])((function(){var e=p.content.split("\n")[0];return"#"==e[0]?e.replace(/#+ /g,""):e}));return Object(a["onBeforeMount"])(k),Object(a["onBeforeUnmount"])(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(JSON.stringify(d.value)===o){e.next=3;break}return e.next=3,Object(w["i"])({noteContent:p.content,postId:p.postId,tags:d.value});case 3:case"end":return e.stop()}}),e)})))),{saveFileName:E,postInfo:p,status:v,showTagManage:f,tagList:d,handleUpdateTags:b,handlePin:V,handlePublic:C,saveNote:N,deleteNote:I,importNote:y,checkIfSaved:_}},L=n("6ee2"),W=n("a834");n("4de4");Object(a["pushScopeId"])("data-v-2f448110");var F={class:"all-tags-wrap"},J=Object(a["createTextVNode"])("+新建标签"),D=Object(a["createTextVNode"])(" 完成 ");Object(a["popScopeId"])();var z=Object(a["defineComponent"])({props:{isShow:{type:Boolean,required:!0},postId:{type:String,required:!0},postTags:{type:Array,required:!0}},emits:["close"],setup:function(e){var t=e,n=Object(a["ref"])(t.isShow),r=Object(a["ref"])("");Object(a["watch"])((function(){return t.isShow}),(function(){n.value=t.isShow}));var c=U(t.postId),o=c.tagList,i=c.allTagList,u=c.showPopInput,s=c.newTagName,l=c.handleSelectTag,f=c.handleAddTag;return Object(a["watch"])((function(){return t.postTags}),(function(){o.value=t.postTags;var e,n=d(o.value);try{var r=function(){var t=e.value,n=i.value.filter((function(e){return e.text==t.text}));n[0].color=B};for(n.s();!(e=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}})),function(e,t){var c=Object(a["resolveComponent"])("van-field"),d=Object(a["resolveComponent"])("van-cell-group"),b=Object(a["resolveComponent"])("van-tag"),p=Object(a["resolveComponent"])("van-action-sheet"),v=Object(a["resolveComponent"])("van-cell"),j=Object(a["resolveComponent"])("van-button"),O=Object(a["resolveComponent"])("van-popup");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(p,{show:n.value,"onUpdate:show":t[3]||(t[3]=function(e){return n.value=e}),title:"添加标签",onClose:t[4]||(t[4]=function(t){return e.$emit("close",Object(a["unref"])(o))})},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(d,{inset:""},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{class:"current-tags-wrap"},{input:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(W["a"],{tags:Object(a["unref"])(o)},null,8,["tags"]),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.value=e}),type:"text",class:"van-field__control",placeholder:"选择或搜索标签"},null,512),[[a["vModelText"],r.value]])]})),_:1})]})),_:1}),Object(a["createVNode"])(d,{inset:"",title:"全部标签"},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("div",F,[Object(a["createElementVNode"])("span",{onClick:t[1]||(t[1]=function(){return Object(a["unref"])(l)&&Object(a["unref"])(l).apply(void 0,arguments)})},[Object(a["createVNode"])(W["a"],{tags:Object(a["unref"])(i),color:"gray"},null,8,["tags"])]),Object(a["createVNode"])(b,{plain:"",onClick:t[2]||(t[2]=function(e){return u.value=!0})},{default:Object(a["withCtx"])((function(){return[J]})),_:1})])]})),_:1})]})),_:1},8,["show"]),Object(a["createVNode"])(O,{class:"new-tag-wrap",show:Object(a["unref"])(u),"onUpdate:show":t[6]||(t[6]=function(e){return Object(a["isRef"])(u)?u.value=e:null}),round:""},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(v,{value:"新建标签"}),Object(a["createVNode"])(d,{inset:""},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{modelValue:Object(a["unref"])(s),"onUpdate:modelValue":t[5]||(t[5]=function(e){return Object(a["isRef"])(s)?s.value=e:null}),placeholder:"标签名称"},null,8,["modelValue"]),Object(a["createVNode"])(j,{type:"primary",disabled:!Object(a["unref"])(s),onClick:Object(a["unref"])(f)},{default:Object(a["withCtx"])((function(){return[D]})),_:1},8,["disabled","onClick"])]})),_:1})]})),_:1},8,["show"])],64)}}});n("e4cc");z.__scopeId="data-v-2f448110";var q=z;Object(a["pushScopeId"])("data-v-4e753016");var $={class:"editor-wrap"},G={class:"tags-wrap"},H=Object(a["createElementVNode"])("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24"},[Object(a["createElementVNode"])("path",{d:"M6.5 10C7.3 10 8 9.3 8 8.5S7.3 7 6.5 7S5 7.7 5 8.5S5.7 10 6.5 10M9 6l7 7l-5 5l-7-7V6h5m0-2H4c-1.1 0-2 .9-2 2v5c0 .6.2 1.1.6 1.4l7 7c.3.4.8.6 1.4.6s1.1-.2 1.4-.6l5-5c.4-.4.6-.9.6-1.4c0-.6-.2-1.1-.6-1.4l-7-7C10.1 4.2 9.6 4 9 4m4.5 1.7l1-1l6.9 6.9c.4.4.6.9.6 1.4s-.2 1.1-.6 1.4L16 19.8l-1-1l5.7-5.8l-7.2-7.3z",fill:"currentColor"})],-1),Y=Object(a["createTextVNode"])("+"),K={class:"v-md-editor-wrap"},Q={class:"uploader-wrap"},X=Object(a["createTextVNode"])(" 导入笔记 "),Z=Object(a["createElementVNode"])("div",{class:"uploader-warn van-action-sheet__subname"}," 从本地文件中导入一篇新的笔记，当前未保存内容可能会丢失 ",-1),ee=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1),te=["download","href"],ne=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1),re={key:0},ae={key:1},ce=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1),oe={key:0},ie={key:1},ue=Object(a["createTextVNode"])(" 公开笔记 "),se=Object(a["createElementVNode"])("div",{class:"uploader-warn van-action-sheet__subname"}," 公开以后，所有人都将能看到您的笔记（只读） ",-1),le=[ue,se],fe=Object(a["createElementVNode"])("div",{class:"van-hairline--bottom"},null,-1);Object(a["popScopeId"])();var de=Object(a["defineComponent"])({setup:function(e){var t=function(){var e=Object(a["ref"])("preview"),t=Object(a["computed"])((function(){return"edit"===e.value})),n=function(){e.value="edit"===e.value?"preview":"edit"};return{mode:e,isEdit:t,showPreview:n}},n=Object(a["ref"])("calc(100vh - var(--van-nav-bar-height))"),i=Object(a["ref"])(!1),u=o(),s=u.getDownloadLink,l=t(),f=l.mode,d=l.isEdit,b=l.showPreview,p=A(f),v=p.status,j=p.postInfo,O=p.saveFileName,h=p.showTagManage,m=p.tagList,g=p.handleUpdateTags,w=p.handlePin,x=p.handlePublic,k=p.saveNote,y=p.deleteNote,N=p.importNote,I=p.checkIfSaved,R=Object(c["c"])(),C=function(){I().then((function(e){1==e&&R.push("/notes")}))},V=function(e){i.value=!1,N(e)},_=function(){i.value=!1,y()},E=function(){k().then((function(){f.value="preview"}))};return Object(a["onMounted"])(Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.onbeforeunload=function(){var e="你确定要关闭吗？";return e};case 1:case"end":return e.stop()}}),e)})))),Object(a["onBeforeUnmount"])((function(){window.onbeforeunload=null})),function(e,t){var r=Object(a["resolveComponent"])("van-button"),c=Object(a["resolveComponent"])("van-nav-bar"),o=Object(a["resolveComponent"])("van-tag"),u=Object(a["resolveComponent"])("v-md-editor"),l=Object(a["resolveComponent"])("van-uploader"),p=Object(a["resolveComponent"])("van-action-sheet");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",$,[Object(a["createVNode"])(c,{title:"MyNote"},{left:Object(a["withCtx"])((function(){return[Object(a["unref"])(d)?(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:0,size:"small",onClick:E},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(L["a"],{name:"save",loading:Object(a["unref"])(v).isSaving},null,8,["loading"])]})),_:1})):(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:1,size:"small",onClick:C},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(L["a"],{name:"back"})]})),_:1}))]})),right:Object(a["withCtx"])((function(){return[Object(a["unref"])(j).canWrite?(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:0,size:"small",onClick:Object(a["unref"])(b)},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(L["a"],{name:"showPreview",active:Object(a["unref"])(d)},null,8,["active"])]})),_:1},8,["onClick"])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(r,{size:"small",onClick:t[0]||(t[0]=function(e){return i.value=!0})},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(L["a"],{name:"showMore"})]})),_:1})]})),_:1}),Object(a["createElementVNode"])("div",G,[H,Object(a["createVNode"])(W["a"],{tags:Object(a["unref"])(m)},null,8,["tags"]),Object(a["createVNode"])(o,{plain:"",onClick:t[1]||(t[1]=function(e){return h.value=!0})},{default:Object(a["withCtx"])((function(){return[Y]})),_:1})]),Object(a["createElementVNode"])("div",K,[Object(a["createVNode"])(u,{modelValue:Object(a["unref"])(j).content,"onUpdate:modelValue":t[2]||(t[2]=function(e){return Object(a["unref"])(j).content=e}),mode:Object(a["unref"])(f),height:n.value,"left-toolbar":"undo redo | toc | ul ol quote table link code | clear","right-toolbar":""},null,8,["modelValue","mode","height"])]),Object(a["createVNode"])(p,{show:i.value,"onUpdate:show":t[6]||(t[6]=function(e){return i.value=e}),"cancel-text":"取消","close-on-click-action":"","safe-area-inset-bottom":""},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("label",Q,[Object(a["createVNode"])(l,{accept:".md, .txt","after-read":V},{default:Object(a["withCtx"])((function(){return[X]})),_:1}),Z]),ee,Object(a["createElementVNode"])("a",{class:"export-wrap",download:Object(a["unref"])(O),href:Object(a["unref"])(s)(Object(a["unref"])(j).content)},[Object(a["createElementVNode"])("button",{class:"van-action-sheet__item",onClick:t[3]||(t[3]=function(e){return i.value=!1})}," 导出笔记 ")],8,te),ne,Object(a["unref"])(j).canWrite?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:0,class:"van-action-sheet__item",onClick:t[4]||(t[4]=function(){return Object(a["unref"])(w)&&Object(a["unref"])(w).apply(void 0,arguments)})},[Object(a["unref"])(j).pinned?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",re,"取消置顶")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",ae,"置顶笔记"))])):Object(a["createCommentVNode"])("",!0),ce,Object(a["unref"])(j).canWrite?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:1,class:"van-action-sheet__item",onClick:t[5]||(t[5]=function(){return Object(a["unref"])(x)&&Object(a["unref"])(x).apply(void 0,arguments)})},[Object(a["unref"])(j).isPublicRead?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",oe,"取消公开")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",ie,le))])):Object(a["createCommentVNode"])("",!0),fe,Object(a["unref"])(j).canWrite?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:2,class:"van-action-sheet__item",style:{color:"red"},onClick:_}," 删除笔记 ")):Object(a["createCommentVNode"])("",!0)]})),_:1},8,["show"]),Object(a["createVNode"])(q,{isShow:Object(a["unref"])(h),postId:Object(a["unref"])(j).postId,postTags:Object(a["unref"])(m),onClose:Object(a["unref"])(g)},null,8,["isShow","postId","postTags","onClose"])])}}});n("60c6");de.__scopeId="data-v-4e753016";t["default"]=de},"25f0":function(e,t,n){"use strict";var r=n("6eeb"),a=n("825a"),c=n("577e"),o=n("d039"),i=n("ad6d"),u="toString",s=RegExp.prototype,l=s[u],f=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=u;(f||d)&&r(RegExp.prototype,u,(function(){var e=a(this),t=c(e.source),n=e.flags,r=c(void 0===n&&e instanceof RegExp&&!("flags"in s)?i.call(e):n);return"/"+t+"/"+r}),{unsafe:!0})},"466d":function(e,t,n){"use strict";var r=n("d784"),a=n("825a"),c=n("50c4"),o=n("577e"),i=n("1d80"),u=n("8aa5"),s=n("14c3");r("match",(function(e,t,n){return[function(t){var n=i(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](o(n))},function(e){var r=a(this),i=o(e),l=n(t,r,i);if(l.done)return l.value;if(!r.global)return s(r,i);var f=r.unicode;r.lastIndex=0;var d,b=[],p=0;while(null!==(d=s(r,i))){var v=o(d[0]);b[p]=v,""===v&&(r.lastIndex=u(i,c(r.lastIndex),f)),p++}return 0===p?null:b}]}))},"4d63":function(e,t,n){var r=n("83ab"),a=n("da84"),c=n("94ca"),o=n("7156"),i=n("9112"),u=n("9bf2").f,s=n("241c").f,l=n("44e7"),f=n("577e"),d=n("ad6d"),b=n("9f7fd"),p=n("6eeb"),v=n("d039"),j=n("5135"),O=n("69f3").enforce,h=n("2626"),m=n("b622"),g=n("fce3"),w=n("107c"),x=m("match"),k=a.RegExp,y=k.prototype,N=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,I=/a/g,R=/a/g,C=new k(I)!==I,V=b.UNSUPPORTED_Y,_=r&&(!C||V||g||w||v((function(){return R[x]=!1,k(I)!=I||k(R)==R||"/a/i"!=k(I,"i")}))),E=function(e){for(var t,n=e.length,r=0,a="",c=!1;r<=n;r++)t=e.charAt(r),"\\"!==t?c||"."!==t?("["===t?c=!0:"]"===t&&(c=!1),a+=t):a+="[\\s\\S]":a+=t+e.charAt(++r);return a},T=function(e){for(var t,n=e.length,r=0,a="",c=[],o={},i=!1,u=!1,s=0,l="";r<=n;r++){if(t=e.charAt(r),"\\"===t)t+=e.charAt(++r);else if("]"===t)i=!1;else if(!i)switch(!0){case"["===t:i=!0;break;case"("===t:N.test(e.slice(r+1))&&(r+=2,u=!0),a+=t,s++;continue;case">"===t&&u:if(""===l||j(o,l))throw new SyntaxError("Invalid capture group name");o[l]=!0,c.push([l,s]),u=!1,l="";continue}u?l+=t:a+=t}return[a,c]};if(c("RegExp",_)){for(var P=function(e,t){var n,r,a,c,u,s,b=this instanceof P,p=l(e),v=void 0===t,j=[],h=e;if(!b&&p&&v&&e.constructor===P)return e;if((p||e instanceof P)&&(e=e.source,v&&(t="flags"in h?h.flags:d.call(h))),e=void 0===e?"":f(e),t=void 0===t?"":f(t),h=e,g&&"dotAll"in I&&(r=!!t&&t.indexOf("s")>-1,r&&(t=t.replace(/s/g,""))),n=t,V&&"sticky"in I&&(a=!!t&&t.indexOf("y")>-1,a&&(t=t.replace(/y/g,""))),w&&(c=T(e),e=c[0],j=c[1]),u=o(k(e,t),b?this:y,P),(r||a||j.length)&&(s=O(u),r&&(s.dotAll=!0,s.raw=P(E(e),n)),a&&(s.sticky=!0),j.length&&(s.groups=j)),e!==h)try{i(u,"source",""===h?"(?:)":h)}catch(m){}return u},S=function(e){e in P||u(P,e,{configurable:!0,get:function(){return k[e]},set:function(t){k[e]=t}})},B=s(k),M=0;B.length>M;)S(B[M++]);y.constructor=P,P.prototype=y,p(a,"RegExp",P)}h("RegExp")},"60c6":function(e,t,n){"use strict";n("7828")},"665b":function(e,t,n){},7156:function(e,t,n){var r=n("861d"),a=n("d2bb");e.exports=function(e,t,n){var c,o;return a&&"function"==typeof(c=t.constructor)&&c!==n&&r(o=c.prototype)&&o!==n.prototype&&a(e,o),e}},7828:function(e,t,n){},"8b10":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("4d63"),n("ac1f"),n("25f0"),n("a15b"),n("466d");var r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=decodeURIComponent(window.location.href),a=1===t.length?new RegExp("[&?]".concat(t[0],"=([^&%#]+)")):new RegExp("[&?](?:".concat(t.join("|"),")=([^&%#]+)")),c=r.match(a);return null===c?void 0:c[1]}}},a434:function(e,t,n){"use strict";var r=n("23e7"),a=n("23cb"),c=n("a691"),o=n("50c4"),i=n("7b0b"),u=n("65f0"),s=n("8418"),l=n("1dde"),f=l("splice"),d=Math.max,b=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,l,f,j,O,h=i(this),m=o(h.length),g=a(e,m),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=m-g):(n=w-2,r=b(d(c(t),0),m-g)),m+n-r>p)throw TypeError(v);for(l=u(h,r),f=0;f<r;f++)j=g+f,j in h&&s(l,f,h[j]);if(l.length=r,n<r){for(f=g;f<m-r;f++)j=f+r,O=f+n,j in h?h[O]=h[j]:delete h[O];for(f=m;f>m-r+n;f--)delete h[f-1]}else if(n>r)for(f=m-r;f>g;f--)j=f+r-1,O=f+n-1,j in h?h[O]=h[j]:delete h[O];for(f=0;f<n;f++)h[f+g]=arguments[f+2];return h.length=m-r+n,l}})},e4cc:function(e,t,n){"use strict";n("665b")}}]);